console.log("[SKMT] Injected script running");const originalLog=console.log,originalInfo=console.info,originalWarn=console.warn,originalError=console.error;function setSkid(t){t&&"string"==typeof t&&t.length>5&&(window.kartStats.skid=t,console.log("[SKMT] SKID detected and set:",t),window.postMessage({type:"SKMT_SKID_UPDATED",skid:t},"*"))}function interceptConsole(t,e){return function(...a){try{originalLog("[SKMT] Intercepted:",t,...a)}catch(t){}if(a[0]&&"string"==typeof a[0]){const t=a[0].toLowerCase();if(t.includes("authstatechanged, uid:")){const t=a[0].match(/uid:\s*([^,\s]+)/i);t&&t[1]&&setSkid(t[1].trim())}if(t.includes("gamedataservice::getgamedatafromserverfirstload")){const t=a[0].trim().split(" ");setSkid(t[t.length-1].trim())}t.includes("bytebrew: sending custom event: play_special_mode")&&(window.kartStats.isSpecialMode=!0),(t.includes("bytebrew: sending custom event: create_game_rules")||t.includes("bytebrew: sending custom event: create_game_weapons")||t.includes("bytebrew: sending custom event: create_game_level")||t.includes("bytebrew: sending custom event: create_game_mode")||t.includes("bytebrew: sending custom event: join_or_create_private_mode")||t.includes("bytebrew: sending custom event: join_or_create_private_arena"))&&(window.kartStats.isCustomMode=!0),(t.includes("bytebrew: sending custom event: game_end")||t.includes("bytebrew: sending custom event: confirmexitgame"))&&window.kartStats.matchActive&&(window.kartStats.matchEndTime=Date.now(),t.includes("confirmexitgame")&&(window.kartStats.quit=!0),window.postMessage({type:"SKMT_MATCH_COMPLETE",data:{kills:window.kartStats.kills,deaths:window.kartStats.deaths,matchStartTime:window.kartStats.matchStartTime,matchEndTime:window.kartStats.matchEndTime,isSpecialMode:window.kartStats.isSpecialMode,isCustomMode:window.kartStats.isCustomMode,joined:window.kartStats.joined,started:window.kartStats.started,quit:window.kartStats.quit}},"*"),resetStats(),window.kartStats.awaitingStartType=!0),window.kartStats.awaitingStartType&&(t.includes("bytebrew: sending custom event: joined_room")?(window.kartStats.kills=0,window.kartStats.deaths=0,window.kartStats.matchActive=!0,window.kartStats.matchStartTime=Date.now(),window.kartStats.joined=!0,window.kartStats.started=!1,window.kartStats.quit=!1,window.kartStats.awaitingStartType=!1):t.includes("bytebrew: sending custom event: start_game")&&(window.kartStats.kills=0,window.kartStats.deaths=0,window.kartStats.matchActive=!0,window.kartStats.matchStartTime=Date.now(),window.kartStats.started=!0,window.kartStats.joined=!1,window.kartStats.quit=!1,window.kartStats.awaitingStartType=!1)),window.kartStats.matchActive&&(t.includes("destroyed_human")&&window.kartStats.kills++,(t.includes("destroyed_by_human")||t.includes("destroyed_by_bot"))&&window.kartStats.deaths++)}e.apply(console,a)}}function resetStats(){window.kartStats.kills=0,window.kartStats.deaths=0,window.kartStats.matchActive=!1,window.kartStats.matchStartTime=null,window.kartStats.matchEndTime=null,window.kartStats.isSpecialMode=!1,window.kartStats.isCustomMode=!1,window.kartStats.joined=!1,window.kartStats.started=!1,window.kartStats.quit=!1,window.kartStats._pendingGameEnd=!1,window.kartStats._successLogCount=0,window.kartStats._gameEndTimeout&&clearTimeout(window.kartStats._gameEndTimeout),window.kartStats._gameEndTimeout=null}window.kartStats={kills:0,deaths:0,matchActive:!1,matchStartTime:null,matchEndTime:null,isSpecialMode:!1,isCustomMode:!1,joined:!1,started:!1,quit:!1,awaitingStartType:!0,_pendingGameEnd:!1,_successLogCount:0,_gameEndTimeout:null,skid:null},console.log=interceptConsole("log",originalLog),console.info=interceptConsole("info",originalInfo),console.warn=interceptConsole("warn",originalWarn),console.error=interceptConsole("error",originalError);